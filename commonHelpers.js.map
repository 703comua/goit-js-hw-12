{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["const API_KEY = '43830047-c5fe5a5c9108224ed65675c7e';\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const PER_PAGE = 15;\n\nimport axios from 'axios';\n\naxios.defaults.baseURL = BASE_URL;\n\nexport const fetchPhotos = async (query, photosCurrentPage = 1) => {\n  const response = await axios.get('', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: PER_PAGE,\n      page: photosCurrentPage,\n    },\n  });\n\n  return response.data;\n};\n","export const createMarkup = images => {\n  return images.reduce(\n    ( html, { tags, webformatURL, largeImageURL, likes, views, comments, downloads } ) => {\n      return (\n        html +\n        `\n\t\t\t<li class=\"gallery__item item-gallery\">\n\t\t\t\t<a class=\"item-gallery__link\" href=\"${largeImageURL}\">\n\t\t\t\t\t<img class=\"item-gallery__img\" src=\"${webformatURL}\" alt=\"${tags}\">\n\t\t\t\t</a>\n\t\t\t\t<ul class=\"item-gallery__data\">\n\t\t\t\t\t<li class=\"item-gallery__data-item\">\n\t\t\t\t\t\t<h2 class=\"item-gallery__subtitle\">Likes</h2>\n\t\t\t\t\t\t<p class=\"item-gallery__counter\">${likes}</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"item-gallery__data-item\">\n\t\t\t\t\t\t<h2 class=\"item-gallery__subtitle\">Views</h2>\n\t\t\t\t\t\t<p class=\"item-gallery__counter\">${views}</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"item-gallery__data-item\">\n\t\t\t\t\t\t<h2 class=\"item-gallery__subtitle\">Comments</h2>\n\t\t\t\t\t\t<p class=\"item-gallery__counter\">${comments}</p>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"item-gallery__data-item\">\n\t\t\t\t\t\t<h2 class=\"item-gallery__subtitle\">Downloads</h2>\n\t\t\t\t\t\t<p class=\"item-gallery__counter\">${downloads}</p>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</li>\n\t\t`\n      );\n    },\n    ''\n  );\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchPhotos, PER_PAGE } from './js/pixabay-api.js';\nimport { createMarkup } from './js/render-functions.js';\n\n// import { testFn } from './js/test.js';\n\nconst galleryEl = document.querySelector('.js-gallery');\nconst searchFormEl = document.querySelector('.js-search-form');\nconst searchFormSubmitBtnEl = document.querySelector(\n  '.js-search-form-submit-btn'\n);\nconst loaderEl = document.querySelector('.js-loader');\nconst loadMoreBtnEl = document.querySelector('.js-load-more-btn');\n\n// Search params\nlet query = '';\nlet photosCurrentPage = 1;\nlet totalPages = 0;\n\nconst lightbox = new SimpleLightbox('.item-gallery__link', {\n  captionsData: 'alt',\n  captionsDelay: 250,\n});\n\n////////////////////////////////\n// -1- Search form submit function\n////////////////////////////////\nconst onSearch = async event => {\n  event.preventDefault();\n  galleryEl.innerHTML = '';\n  photosCurrentPage = 1;\n\n  // Hide laod more btn\n  hideLoadMoreBtn();\n\n  // Get query string\n  const form = event.currentTarget;\n  query = form.elements.searchword.value.trim();\n\n  // Check is empty query\n  if (query === '') {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n    });\n    form.reset();\n    return;\n  }\n\n  try {\n    // Disable search form submit button\n    disableSearchFormSubmitBtn();\n\n    // Show loader\n    showLoader();\n\n    // Get photos data\n    const { hits, totalHits } = await fetchPhotos(query, photosCurrentPage);\n\n    // Check is empty query\n    if (totalHits === 0) {\n      // Enable search form submit button\n      enableSearchFormSubmitBtn();\n\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      form.reset();\n      hediLoader();\n      return;\n    }\n\n    // Render photos\n    galleryEl.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n    lightbox.refresh();\n\n    // Hide loader\n    hediLoader();\n\n    // Enable search form submit button\n    enableSearchFormSubmitBtn();\n\n    totalPages = Math.ceil(totalHits / PER_PAGE);\n    if (totalPages > 1) {\n      // Show laod more btn\n      showLoadMoreBtn();\n    }\n  } catch (error) {\n    // Enable search form submit button\n    enableSearchFormSubmitBtn();\n\n    // Hide loader\n    hideLoader();\n\n    iziToast.error({\n      message: 'Search params is not valid!',\n      position: 'topRight',\n    });\n    form.reset();\n    return;\n  }\n\n  // Reset search form\n  form.reset();\n};\n\n// Load search form submit\nsearchFormEl.addEventListener('submit', onSearch);\n\nconst smoothScrollOnLoadMore = () => {\n  const lastPhoto = document.querySelector('.gallery__item');\n  const photosHeight = lastPhoto.getBoundingClientRect().height;\n  // console.log(\" photosHeight:\", photosHeight)\n  const twoPhotosHeight = photosHeight * 2;\n  // console.log(\"twoPhotosHeight:\", twoPhotosHeight)\n  window.scrollBy({\n    top: twoPhotosHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n  // window.scrollBy(0, 1000);\n  // window.scrollBy(0, window.innerHeight);\n};\n\n////////////////////////////////\n// -2- Load more btn press function\n////////////////////////////////\nconst onLoadMorePress = async event => {\n  try {\n    // Hide laod more btn\n    hideLoadMoreBtn();\n\n    // Show loader\n    showLoader();\n\n    photosCurrentPage += 1;\n\n    // Get photos data\n    const { hits, totalHits } = await fetchPhotos(query, photosCurrentPage);\n\n    // Render photos\n    galleryEl.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n    lightbox.refresh();\n\n    smoothScrollOnLoadMore();\n\n    // Hide loader\n    hediLoader();\n\n    totalPages = Math.ceil(totalHits / PER_PAGE);\n    if (photosCurrentPage < totalPages) {\n      // Show laod more btn\n      showLoadMoreBtn();\n    } else {\n      loadMoreBtnEl.removeEventListener('click', onLoadMorePress);\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      return;\n    }\n  } catch (error) {\n    // Enable search form submit button\n    enableSearchFormSubmitBtn();\n\n    // Hide loader\n    hideLoader();\n\n    iziToast.error({\n      message: 'Search params is not valid!',\n      position: 'topRight',\n    });\n    form.reset();\n    return;\n  }\n};\n\n// Load more btn click\nloadMoreBtnEl.addEventListener('click', onLoadMorePress);\n\n///////////\n// Helpers\n///////////\nfunction hediLoader() {\n  loaderEl.classList.add('is-hidden');\n}\n\nfunction showLoader() {\n  loaderEl.classList.remove('is-hidden');\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtnEl.classList.remove('is-hidden');\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtnEl.classList.add('is-hidden');\n}\n\nfunction disableSearchFormSubmitBtn() {\n  searchFormSubmitBtnEl.classList.add('is-disabled');\n}\n\nfunction enableSearchFormSubmitBtn() {\n  searchFormSubmitBtnEl.classList.remove('is-disabled');\n}\n\n// galleryEl.innerHTML = '';\n\n// const testFormEl = document.querySelector('.js-test-form');\n// testFormEl.addEventListener('submit', onTestFormSearch);\n\n// function onTestFormSearch() {\n//   event.preventDefault();\n//   testFn();\n// }\n"],"names":["API_KEY","BASE_URL","PER_PAGE","axios","fetchPhotos","query","photosCurrentPage","createMarkup","images","html","tags","webformatURL","largeImageURL","likes","views","comments","downloads","galleryEl","searchFormEl","searchFormSubmitBtnEl","loaderEl","loadMoreBtnEl","totalPages","lightbox","SimpleLightbox","onSearch","event","hideLoadMoreBtn","form","iziToast","disableSearchFormSubmitBtn","showLoader","hits","totalHits","enableSearchFormSubmitBtn","hediLoader","showLoadMoreBtn","smoothScrollOnLoadMore","twoPhotosHeight","onLoadMorePress"],"mappings":"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"}